<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>BUNCLE STORE</title>
<link rel="shortcut icon" href="/buncle/img/favicon_logo.ico" type="image/x-icon">
<link href="/buncle/css/submit_stye.css" type="text/css" rel="stylesheet">
<script src="/buncle/js/jquery-2.1.1.min.js" type="text/javascript"></script>
<script src="/buncle/js/Submit_page.js" type="text/javascript"></script>
<style type="text/css">
  .layui-upload-file{
    display: none;
  }
</style>
</head>

<body>
	<!--=====导航栏=====-->
  	<div id="nav">
  		<div class="nav_logo">
  			<h1><img src="/buncle/img/logo.png"></h1>
  		</div>
  		<ul>
  			<li>
  				<a href="__APP__/index">首页</a>
  				<i></i>
  			</li>
  			<li>
  				<a href="__APP__/index">交易所</a>
  				<i></i>
  			</li>
  			<li>
  				<a href="__APP__/index">钱包</a>
  				<i></i>
  			</li>
  			<li>
  				<a href="__APP__/index">媒体</a>
  				<i></i>
  			</li>
  			<li>
  				<a href="__APP__/index">DAPP</a>
  				<i></i>
  			</li>
  		</ul>
  		<div class="btn_app">提交应用</div>
  	</div>
  	<div class="sub_bg"></div>
  	<!--=====form表单=====-->
  	<form action="###" id="action">
  		<ul>
  			<li>
  				<span>APP名称</span><br>
  				<input type="text" alt="" id="title" class="inp_txt">
  			</li>
  			<li>
  				<span>产品slogan</span><p>(12字以内)</p><br>
  				<input type="text" alt="" id="short_title" maxlength="12" class="inp_txt">
  			</li>
  			<li>
  				<span>简介</span><br>
  				<input type="text" alt="" id="content" class="inp_txt">
  			</li>
  			<li class="ind">
  				<span>应用类别</span><br>
  				<div class="box_opt">请选择</div>
          <input type="hidden" id="agent" name="">
  				<div class="sel_box">
					<div class="opt opt_title">应用类别:</div>
					<div class="opt opt_txt" data-type='1'>交易所</div>
					<div class="opt opt_txt" data-type='3'>钱包</div>
					<div class="opt opt_txt" data-type='2'>媒体资讯</div>
					<div class="opt opt_txt" data-type='4'>其他应用</div>
				</div>
  			</li>
  			<li>
  				<span>官网</span><br>
  				<input type="text" alt="" id="url" class="inp_txt">
  			</li>
  			<li>
  				<span>安卓下载链接</span><br>
  				<input type="text" alt="" id="android" class="inp_txt">
  			</li>
  			<li>
  				<span>IOS下载链接</span><br>
  				<input type="text" alt="" id="ios" class="inp_txt">
  			</li>
  			<div class="file file_logo">
				<div class="img_all logo_img" id="logo">
					<!-- <input type="file" class="btn_file"> -->
					<span>上传LOGO</span>
				</div>
				<p>统一正方形LOGO大小建议<br>大于500*500等倍大小</p>
			</div>
			<div class="file file_baneer">
				<div class="img_all baner_img" id="thumb">
					<!-- <input type="file" class="btn_file"> -->
					<span>上传BANNER</span>
				</div>
				<p>应用下载页顶部BANNER统一大小建议1125*610</p>
			</div>
			<li>
  				<span>是否赞助</span><br>
          <input type="hidden" id="zanzhu" value="1" name="">
  				<div class="inp_box">
  					<div class="inp_bt bt" data-add="yes">
  						<div class="bt_rdio bt_yes"></div>
  						<b>是</b>
  					</div>
  					<div class="inp_bt" data-add="no">
  						<div class="bt_rdio bt_no"></div>
  						<b>否</b>
  					</div>
  				</div>
  			</li>
  			<ul class="mod_box">
				<li>
					<span>赞助内容</span><br>
					<input type="text" alt="" id="zanzhu_con" class="inp_txt">
				</li>
				<li>
					<span>赞助数量</span><br>
					<input type="text" alt="" id="zanzhu_num" class="inp_txt">
				</li>
			</ul>
  			<li class="der">
  				<span>您的微信</span><br>
  				<input type="text" alt="" id="wetch" class="inp_txt">
  			</li>
  		</ul>
  		
  		<div class="pro_text">注：带 <span>*</span> 为必填项，提交应用时请添加客服微信：buncle001</div>
  		<div class="ment_text">
			<input type="checkbox" name="checkbox" checked="checked">
			<a href="###">我已阅读并同意《用户协议及隐私政策》</a>
 		</div>
  		<div class="sub_btn">
  			<input type="button" id="submit" value="提交应用">
  		</div>
  	</form>
  	<!--=====结尾=====-->
  	<div id="tail">
  		<i></i>
  		<span>渝ICP备18009573号-2</span>
  		<p>Copyright © 2019 BUNCLE . buncle all rights reserved</p>
  	</div>
</body>

<script src="__PUBLIC__/jquery.min.js"></script>
<script src="__PUBLIC__/layer/layer.js"></script> 
<script src="__PUBLIC__/layui/layui.js"></script>
<script type="text/javascript">

  $(document).ready(function() {
      $('input[type=radio][name=zanzhu]').change(function() {
         if (this.value == 1) {
              $('.zanzhu').show();
          }
          else if (this.value == 0) {
             $('.zanzhu').hide();
          }
      });
 });
  var imgs='',thumb='';
    layui.use(['form', 'layedit', 'laydate','upload'], function(){
  var form = layui.form
  ,layer = layui.layer
  ,layedit = layui.layedit
  ,laydate = layui.laydate;
    var $ = layui.jquery
  ,upload = layui.upload;
 var uploadInst = upload.render({
    elem: '#logo'
    ,url: '__APP__/admin/base/uploadimg'
    , multiple:true
    ,number:1
    ,before: function(obj){
      //预读本地文件示例，不支持ie8
      // obj.preview(function(index, file, result){
      //   $('#demo1').attr('src', result); //图片链接（base64）
      // });
    }
    ,done: function(res){
      //如果上传失败
      if(res.code==0){
       
        var img = '<img src="__PUBLIC__/uploads/'+res.url+'" style="width:100%;height:100%;margin:0;">';
        $('#logo').html(img);
        imgs=res.url;
        console.log(img);
      }
      if(res.code > 0){
        return layer.msg(res.msg);
      }
      //上传成功
    }
    ,error: function(){
      //演示失败状态，并实现重传
      var demoText = $('#demoText');
      demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
      demoText.find('.demo-reload').on('click', function(){
        uploadInst.upload();
      });
    }
  });
  var uploadIns = upload.render({
    elem: '#thumb'
    ,url: '__APP__/admin/base/uploadimg'
    , multiple:true
    ,number:1
    ,before: function(obj){
      //预读本地文件示例，不支持ie8
      // obj.preview(function(index, file, result){
      //   $('#demo1').attr('src', result); //图片链接（base64）
      // });
    }
    ,done: function(res){
      //如果上传失败
      if(res.code==0){
       
        var img = '<img src="__PUBLIC__/uploads/'+res.url+'" style="width:100%;height:100%;margin:0;">';
        $('#thumb').html(img);
        thumb=res.url;
        console.log(img);
      }
      if(res.code > 0){
        return layer.msg(res.msg);
      }
      //上传成功
    }
    ,error: function(){
      //演示失败状态，并实现重传
      var demoText = $('#demoText');
      demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
      demoText.find('.demo-reload').on('click', function(){
        uploadInst.upload();
      });
    }
  });

 $('#submit').click(function(){
  
  var title = $('#title').val();
  var ios = $('#ios').val();
  var url = $('#url').val();
  var content = $('#content').val();
  var agent = $("#agent").val();
  var android = $('#android').val(); 
  var wetch = $('#wetch').val();
  var zanzhu = $("#zanzhu").val();
  var zanzhu_num = $('#zanzhu_num').val();
  var zanzhu_con = $('#zanzhu_con').val();
  var short_title = $('#short_title').val();
  if(title==''){
    layer.msg('请输入APP名称');
    return false;
  }
  if(short_title==''){
    layer.msg('请输入产品slogan');
    return false;
  }

  if(content==''){
    layer.msg('请输入简介');
    return false;
  }

  if(agent==''){
    layer.msg('请选择产品类别');
    return false;
  }

  if(url==''){
    layer.msg('请输入官网');
    return false;
  }

  if(android==''){
    layer.msg('请输入安卓下载地址');
    return false;
  }
  if(ios==''){
    layer.msg('请输入IOS下载地址');
    return false;
  }

  if(imgs==''){
    layer.msg('请上传LOGO');
    return false;
  }
  if(zanzhu==1){
    if(zanzhu_con==''){
      layer.msg('请输入赞助内容');
      return false;
    }
    if(zanzhu_num==''){
      layer.msg('请输入赞助数量');
      return false;
    }
  }
  if(wetch==''){
    layer.msg('请输入您的微信');
    return false;
  }
  var load = layer.load(1);
  $.ajax({
    url:'__APP__/test/app/addapp',
    type:'post',
    dataType:'json',
    data:{
      title:title,
      logo:imgs,
      ios:ios,
      android:android,
      url:url,
      content:content,
      agent:agent,
      short_title:short_title,
      zanzhu:zanzhu,
      zanzhu_con:zanzhu_con,
      zanzhu_num:zanzhu_num,
      thumb:thumb,
      wetch:wetch
     
    },success:function(res){
      layer.close(load);
        if(res.code==0){
           layer.msg('提交成功');
        }else{
          layer.msg('提交失败');
        }
    }
  })
})

});
  </script>
</html>
